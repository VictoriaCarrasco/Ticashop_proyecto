{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{% block title %}Dashboard RRHH{% endblock %}</title>

  <link rel="stylesheet" href="{% static 'css/main.css' %}?v=4">
  {% block head %}{% endblock %}
  {% block extra_css %}{% endblock %}
</head>

<body>
  <div class="layout">
    <!-- SIDEBAR IZQUIERDA -->
    <aside class="barra-lateral">
      <div class="marca">Dashboard RRHH</div>
      <nav class="menu" aria-label="Navegación principal">
        <a href="{% url 'dashboard' %}" data-ruta="{% url 'dashboard' %}">Inicio</a>
        {% if empleado_actual %}
          {# VACACIONES: ADMIN, GENERAL, TECNICO, RRHH #}
          {% if empleado_actual.rol == "ADMIN" or empleado_actual.rol == "GENERAL" or empleado_actual.rol == "TECNICO" or empleado_actual.rol == "RRHH" %}
            <a href="{% url 'vacaciones_list' %}" data-ruta="{% url 'vacaciones_list' %}">Vacaciones</a>
          {% endif %}
          
          <a href="{% url 'liquidaciones_list' %}" data-ruta="{% url 'liquidaciones_list' %}">
            {% if empleado_actual.rol == "NOMINA" %}
              Liquidaciones
            {% else %}
              Mis liquidaciones
            {% endif %}
          </a>

          {# COMISIONES: ADMIN, JEFATURA, SUP_COM #}
          {% if empleado_actual.rol == "ADMIN" or empleado_actual.rol == "JEFATURA" or empleado_actual.rol == "SUP_COM" %}
            <a href="{% url 'comisiones_list' %}" data-ruta="{% url 'comisiones_list' %}">Comisiones</a>
          {% endif %}

          {# ASISTENCIA: ADMIN, JEFATURA, RRHH #}
          {% if empleado_actual.rol == "ADMIN" or empleado_actual.rol == "JEFATURA" or empleado_actual.rol == "RRHH" %}
            <a href="{% url 'asistencia_list' %}" data-ruta="{% url 'asistencia_list' %}">Asistencia</a>
          {% endif %}

          {# ADMINISTRACIÓN: ADMIN, JEFATURA #}
          {% if empleado_actual.rol == "ADMIN" or empleado_actual.rol == "JEFATURA" %}
            <a href="{% url 'admin_home' %}">Administración</a>
          {% endif %}
        {% endif %}
      </nav>

      {% if request.user.is_authenticated %}
        <div style="padding: 8px; font-size: 12px;">
          Sesión: {{ request.user.email }}<br>

          {% if empleado_actual %}
            Rol: {{ empleado_actual.rol }}<br>
            Departamento: {{ empleado_actual.departamento }}<br>
          {% endif %}

          <a href="{% url 'logout_empleado' %}">Cerrar sesión</a>
        </div>
      {% endif %}
    </aside>

      <!-- CONTENIDO -->
      <main class="contenido">
        {# MENSAJES GLOBALES (éxito, error, info, etc.) #}
        {% if messages %}
          <div class="messages-container" style="margin-bottom: 12px;">
            {% for message in messages %}
              <div
                class="alert alert-{{ message.tags }}"
                style="
                  padding: 8px 12px;
                  border-radius: 6px;
                  font-size: 13px;
                  margin-bottom: 6px;
                  {% if message.tags == 'success' %}
                    background:#ecfdf3; color:#15803d; border:1px solid #bbf7d0;
                  {% elif message.tags == 'error' or message.tags == 'danger' %}
                    background:#fef2f2; color:#b91c1c; border:1px solid #fecaca;
                  {% elif message.tags == 'warning' %}
                    background:#fffbeb; color:#92400e; border:1px solid #fef3c7;
                  {% else %}
                    background:#eff6ff; color:#1d4ed8; border:1px solid #bfdbfe;
                  {% endif %}
                "
              >
                {{ message }}
              </div>
            {% endfor %}
          </div>
        {% endif %}
  
        {% block content %}{% endblock %}
        <footer class="footer">© {{ now|date:"Y" }} Ticashop</footer>
      </main>
  
  </div>

  {% block scripts %}{% endblock %}
</body>
</html>
